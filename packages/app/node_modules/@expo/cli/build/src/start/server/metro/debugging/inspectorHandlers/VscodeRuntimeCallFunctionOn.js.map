{"version":3,"sources":["../../../../../../../src/start/server/metro/debugging/inspectorHandlers/VscodeRuntimeCallFunctionOn.ts"],"sourcesContent":["import Protocol from 'devtools-protocol';\n\nimport {\n  CdpMessage,\n  DebuggerMetadata,\n  DebuggerRequest,\n  DeviceResponse,\n  InspectorHandler,\n} from './types';\nimport { getDebuggerType, respond } from './utils';\n\n/**\n * Vscode is trying to inject a script to fetch information about \"Stringy\" variables.\n * Unfortunately, this script causes a Hermes exception and crashes the app.\n *\n * @see https://github.com/expo/vscode-expo/issues/231\n * @see https://github.com/microsoft/vscode-js-debug/blob/dcccaf3972d675cc1e5c776450bb4c3dc8c178c1/src/adapter/stackTrace.ts#L319-L324\n */\nexport class VscodeRuntimeCallFunctionOnHandler implements InspectorHandler {\n  onDebuggerMessage(\n    message: DebuggerRequest<RuntimeCallFunctionOn>,\n    { socket, userAgent }: DebuggerMetadata\n  ): boolean {\n    if (getDebuggerType(userAgent) === 'vscode' && message.method === 'Runtime.callFunctionOn') {\n      return respond<DeviceResponse<RuntimeCallFunctionOn>>(socket, {\n        id: message.id,\n        result: {\n          // We don't know the `type` and vscode allows `type: undefined`\n          result: { objectId: message.params.objectId } as any,\n        },\n      });\n    }\n\n    return false;\n  }\n}\n\n/** @see https://chromedevtools.github.io/devtools-protocol/v8/Runtime/#method-callFunctionOn */\nexport type RuntimeCallFunctionOn = CdpMessage<\n  'Runtime.callFunctionOn',\n  Protocol.Runtime.CallFunctionOnRequest,\n  Protocol.Runtime.CallFunctionOnResponse\n>;\n"],"names":["VscodeRuntimeCallFunctionOnHandler","onDebuggerMessage","message","socket","userAgent","getDebuggerType","method","respond","id","result","objectId","params"],"mappings":"AAAA;;;;AASyC,IAAA,MAAS,WAAT,SAAS,CAAA;AAS3C,MAAMA,kCAAkC;IAC7CC,iBAAiB,CACfC,OAA+C,EAC/C,EAAEC,MAAM,CAAA,EAAEC,SAAS,CAAA,EAAoB,EAC9B;QACT,IAAIC,CAAAA,GAAAA,MAAe,AAAW,CAAA,gBAAX,CAACD,SAAS,CAAC,KAAK,QAAQ,IAAIF,OAAO,CAACI,MAAM,KAAK,wBAAwB,EAAE;YAC1F,OAAOC,CAAAA,GAAAA,MAAO,AAMZ,CAAA,QANY,CAAwCJ,MAAM,EAAE;gBAC5DK,EAAE,EAAEN,OAAO,CAACM,EAAE;gBACdC,MAAM,EAAE;oBACN,+DAA+D;oBAC/DA,MAAM,EAAE;wBAAEC,QAAQ,EAAER,OAAO,CAACS,MAAM,CAACD,QAAQ;qBAAE;iBAC9C;aACF,CAAC,CAAC;SACJ;QAED,OAAO,KAAK,CAAC;KACd;CACF;QAjBYV,kCAAkC,GAAlCA,kCAAkC"}